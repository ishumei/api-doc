# Shumei Tianxiang Product API Interface Documentation
## Device Risk Profile

- - - - -

***All rights reserved. Unauthorized reproduction is prohibited.***

- - - - -

Table of Contents

- [Shumei Tianxiang Product API Interface Documentation](#shumei-tianxiang-product-api-interface-documentation)
  - [Device Risk Profile](#device-risk-profile)
- [Tianxiang Risk Identification](#tianxiang-risk-identification)
  - [Invocation Timing](#invocation-timing)
  - [Tianxiang Data Flow Diagram](#tianxiang-data-flow-diagram)
  - [Specific Interface](#specific-interface)
    - [Request URL:](#request-url)
    - [Request Method:](#request-method)
    - [Character Encoding:](#character-encoding)
    - [Suggested Timeout:](#suggested-timeout)
    - [Request Parameters:](#request-parameters)
  - [Return Results](#return-results)
  - [Example:](#example)
    - [Request Example:](#request-example)
    - [Return Example:](#return-example)

# Tianxiang Risk Identification

## Invocation Timing

Invoke this interface when risk identification is needed, for example:

1. After new user registration, perform a risk profile query for differentiated distribution of newcomer red packets, registration gifts, etc.;
2. After existing users log in, perform a risk profile query for differentiated distribution in daily activity operations;
3. Before issuing activity rewards, perform a risk profile query, such as for random red packets, lottery draws, etc.;
4. Daily routine queries to update the profile database or risk control engine data.

## Tianxiang Data Flow Diagram

<img alt="" src="./res/tianxiangliucheng.png" />


## Specific Interface

### Request URL:
| Cluster | URL | Supported Product List |
| --- | --- | --- |
| Beijing | `http://api-tianxiang-bj.fengkongcloud.com/tianxiang/v4` | Tianxiang Risk Identification |
| Singapore | `http://api-tianxiang-xjp.fengkongcloud.com/tianxiang/v4` | Tianxiang Risk Identification |
| Frankfurt | `http://api-tianxiang-eur.fengkongcloud.com/tianxiang/v4` | Tianxiang Risk Identification |
| Virginia | `http://api-tianxiang-fjny.fengkongcloud.com/tianxiang/v4` | Tianxiang Risk Identification |

### Request Method:

`POST`

### Character Encoding:

`UTF-8`

### Suggested Timeout:

1s

### Request Parameters:

Placed in the HTTP Body in JSON format, specific parameters are as follows:

| **Request Parameter Name** | **Type** | **Parameter Description** | **Transmission Description** | **Specification** |
| --- | --- | --- | --- | --- |
| accessKey | string | Interface authentication key<br/>Used for permission authentication, provided by Shumei when opening account services or viewed in the relevant documentation section in the upper right corner of the Shumei backend after logging in with the opening email | Required | Assigned by Shumei |
| data | json_object | Request data content | Required | Request data content, maximum 10MB, [see data parameter](#data)  |

Among them, the content of data is as follows:

| **Request Parameter Name** | **Type** | **Parameter Description** | **Is Required** | **Specification** |
| --- | --- | --- | --- | --- |
| deviceId | string | Device fingerprint ID to be queried, generated by Shumei SDK | Required | Pass in the value obtained by calling the getDeviceId() method on the front end |


## Return Results

Placed in the HTTP Body in JSON format, specific parameters are as follows:

| **Parameter Name** | **Parameter Type** | **Parameter Description** | **Is Required** | **Specification** |
| --- | --- | --- | --- | --- |
| code | int | Return code | Yes |  `1100`: Success<br/>`1901`: QPS limit exceeded<br/>`1902`: Invalid parameter<br/>`1903`: Service failure<br/>`9101`: Unauthorized operation<br/>Fields other than message and requestId will only exist when code is 1100 |
| message | string | Return code description | Yes | Corresponding to code: `Success QPS limit exceeded Invalid parameter Service failure Insufficient balance Unauthorized operation` |
| requestId | string | Request identifier | Yes | Unique request identifier, used for troubleshooting and subsequent effect optimization, strongly recommended to save |
| profileExist       | int          | Device profile exists | Yes | `1`: Device information exists in the profile database`0`: Device information does not exist in the profile database    |
| tokenLabels        | json_object  | Account label information | No | See details below, returned only when tokenId is passed in and the service is enabled |
| deviceLabels       | json_object  | Device label information | No | See details below, returned only when deviceId is passed in and the service is enabled |
| tokenProfileLabels | json_object   | Account attribute labels | No | See details below, returned only when tokenId is passed in and the service is enabled |
| tokenRiskLabels    | json_object   | Account risk labels | No | See details below, returned only when tokenId is passed in and the service is enabled |
| deviceRiskLabels   | json_object   | Device risk labels | No | See details below, returned only when deviceId is passed in and the service is enabled |
| devicePrimayInfo   | json_object | Device basic attribute labels  | No  | This service needs to be enabled separately and involves charges. If needed, please contact the business team. This parameter will return device data reported after restarting the SDK post-enablement, only supporting queries for device data reported within the last 24 hours. |

Among them

**1) Details of tokenLabels**

| ***Return Result Parameter Name*** | ***Parameter Type*** | ***Parameter Description***   | ***Specification***                 |
| -------------------- | -------------- | ---------------- | -------------------------- |
| machine_account_risk | json_object    | Machine control related risk |                            |
| UGC_account_risk     | json_object    | UGC content related risk  |                            |
| scene_account_risk   | json_object    | Scene account risk     | Only available in special scenarios, such as airlines |

Details of machine_account_risk are as follows:

| ***Return Result Parameter Name***              | ***Parameter Type*** | ***Parameter Description*** | ***Specification***                       |
| --------------------------------- | -------------- | -------------- | -------------------------------- |
| b_machine_control_tokenid         | int            | Machine account       | 0: Non-machine control account 1: Machine control account |
| b_machine_control_tokenid_last_ts | int            | Machine account time   |                                  |
| b_offer_wall_tokenid              | int            | Points wall account     | 0: Non-points wall account 1: Points wall account     |
| b_offer_wall_tokenid_last_ts      | int            | Points wall account time |                                  |

Details of UGC_account_risk are as follows:

| ***Return Result Parameter Name***             | ***Parameter Type*** | ***Parameter Description*** | ***Specification***                         |
| -------------------------------- | -------------- | -------------- | ---------------------------------- |
| b_politics_risk_tokenid          | int            | Political risk       | 0: No political risk found 1: Political risk exists |
| b_politics_risk_tokenid_last_ts  | int            | Political risk time   |                                    |
| b_sexy_risk_tokenid              | int            | Pornographic risk       | 0: No pornographic risk found 1: Pornographic risk exists |
| b_sexy_risk_tokenid_last_ts      | int            | Pornographic risk time   |                                    |
| b_advertise_risk_tokenid         | int            | Advertising risk       | 0: No advertising risk found 1: Advertising risk exists |
| b_advertise_risk_tokenid_last_ts | int            | Advertising risk time   |                                    |

Details of scene_account_risk are as follows:

| ***Return Result Parameter Name***    | ***Parameter Type*** | ***Parameter Description*** | ***Specification***                   |
| --------------------------- | ------------------ | ------------------ | -------------------------------- |
| i_tout_risk_tokenid         | int                | Airline seat account       | 0: Non-airline seat account 1: Airline seat account |
| i_tout_risk_tokenid_last_ts | int                | Airline seat time       |                                  |

 **2) Details of deviceLabels**

| ***Return Result Parameter Name*** | ***Parameter Type*** | ***Parameter Description***         | ***Specification***         |
| ------------------------ | ------------------ | -------------------------- | ---------------------- |
| id                       | string             | Device identifier                   |                        |
| last_active_ts           | int                | Last upload time of device data   | Can be used as the last update time of the label |
| fake_device              | json_object        | Labels related to false information     |                        |
| device_suspicious_labels | json_object        | Labels related to suspicious devices     |                        |
| device_active_info       | json_object        | Labels related to active devices     |                        |
| monkey_device            | Json_object        | Labels related to machine-controlled devices |                        |

Details of fake_device are as follows:

| ***Return Result Parameter Name***      | ***Parameter Type*** | ***Parameter Description***       | ***Specification***                                               |
| ----------------------------- | ------------------ | ------------------------ | ------------------------------------------------------------ |
| b_pc_emulator                 | int                | PC emulator                 | Android emulator running on PC, such as LDPlayer, value: 0: Non-PC emulator 1: PC emulator |
| b_pc_emulator_pc_id           | string             | PC device ID where the PC emulator is located    |  |
| b_pc_emulator_last_ts         | int                | PC emulator time             |                                                              |
| b_cloud_device                | int                | Cloud phone device               | Cloud phone device, such as Redfinger, value: 0: Non-cloud phone device 1: Cloud phone device |
| b_cloud_device_last_ts        | int                | Cloud phone device time           |                                                              |
| b_altered                     | int                | Tampered device                 | Device information is tampered, causing the device ID to be altered, value: 0: Non-tampered device 1: Tampered device |
| b_altered_last_ts             | int                | Tampered device time             |                                                              |
| b_multi_boxing                | int                | Multi-instance device                 | Multi-instance tool for multi-instance, such as DualSpace, and the current APP is in a multi-instance environment, value: 0: Not in a multi-instance environment 1: In a multi-instance environment |
| b_multi_boxing_last_ts        | int                | Multi-instance device time             |                                                              |
| b_faker                       | int                | Fake device                 | Device data is missing or falsified, leading to malicious behavior of falsifying device ID to hit business interfaces, value: 0: Non-fake device 1: Fake device |
| b_faker_last_ts               | int                | Fake device time             |                                                              |
| b_farmer                      | int                | Farm device                 | Multiple devices with automated operations, forming a device farm for mass malicious activities, value: <br/>0: Non-farm device<br/>1: Farm device |
| b_farmer_last_ts              | int                | Farm device time             |                                                              |
| b_offerwall                   | int                | Points wall device               | Device installed with points wall or other earning tools, value: <br/>0: Non-points wall device<br/>1: Points wall device |
| b_offerwall_last_ts           | int                | Points wall device time           |                                                              |
| other                         | json_object        | Other false devices             |                                                              |
| b_phone_emulator              | int                | Phone emulator               | Android emulator running on phone, such as VMOS, value: <br/>0: Non-phone emulator<br/>1: Phone emulator |
| b_phone_emulator_last_ts      | int                | Phone emulator time           |                                                              |
| b_alter_apps                  | int                | Installed tampering tools             | Device installed with tampering tools, such as: App Cloner, value: <br/>0: Device not installed with tampering tools<br/>1: Device installed with tampering tools |
| b_alter_apps_last_ts          | int                | Installed tampering tools time         |                                                              |
| b_alter_route                 | int                | Tampered location             | Device tampered with GPS location, value: <br/>0: Device did not tamper with GPS information<br/>1: Device tampered with GPS information |
| b_alter_route_last_ts         | int                | Last time tampered location label | 13-digit timestamp                                                   |
| b_alter_route_periods         | array              | Tampered location travel periods   | Value is the time period from the first to the last detection of tampered location in each trip. Example: b_alter_route_periods：[1616688431748- 1616688431749, 1616688431766- 1616688431799] |
| b_multi_boxing_by_os          |                    | System multi-instance                 | System built-in multi-instance, and the current APP is in a multi-instance environment, value: <br/>0: Not in a multi-instance environment<br/>1: In a multi-instance environment |
| b_multi_boxing_by_os_last_ts  | int                | Last time system multi-instance     | 13-digit timestamp                                                   |
| b_multi_boxing_by_app         |                    | Tool multi-instance                 | Multi-instance tool for multi-instance, such as DualSpace, and the current APP is in a multi-instance environment, value: <br/>0: Not in a multi-instance environment<br/>1: In a multi-instance environment |
| b_multi_boxing_by_app_last_ts | int                | Last time tool multi-instance     | 13-digit timestamp                                                   |

Details of other are as follows:

| ***Return Result Parameter Name*** | ***Parameter Type*** | ***Parameter Description***     | ***Specification***                                                   |
| -------------------- | -------------- | ------------------ | ------------------------------------------------------------ |
| b_mismatch           | int            | Device parameter mismatch     | Device parameters do not match normal parameters, such as an 8-core phone detected as 3-core, value: 0: Parameters normal 1: Parameters abnormal |
| b_mismatch_last_ts   | int            | Device parameter mismatch time |                                                              |

Details of device_suspicious_labels are as follows:

| ***Return Result Parameter Name*** | ***Parameter Type*** | ***Parameter Description***            | ***Specification***                                                                                                                                                                                                              |
|------------------------------------|----------------------|----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| b_root                             | int                  | Root device                            | Device is rooted, value: <br/>0: Device not rooted<br/>1: Device rooted                                                                                                                                                          |
| b_root_last_ts                     | int                  | Root time                              |                                                                                                                                                                                                                                  |
| b_sim                              | int                  | SIM card status                        | Device SIM card status abnormal, such as no SIM card or SIM card not working properly, value: <br/>0: SIM card status normal<br/>1: SIM card status abnormal                                                                     |
| b_sim_last_ts                      | int                  | SIM card time                          |                                                                                                                                                                                                                                  |
| b_debuggable                       | int                  | Debug mode                             | Debug mode enabled, could be developer or black industry, value: <br/>0: Not in debug mode<br/>1: In debug mode                                                                                                                  |
| b_debuggable_last_ts               | int                  | Debug mode time                        |                                                                                                                                                                                                                                  |
| b_vpn                              | int                  | VPN                                    | Using VPN proxy IP, possibly for bypassing or malicious activities, value: <br/>0: Not using VPN<br/>1: Using VPN                                                                                                                |
| b_vpn_last_ts                      | int                  | VPN time                               |                                                                                                                                                                                                                                  |
| b_monkey_apps                      | int                  | Automation tools                       | Device installed with automation frameworks such as Auto.js, value: <br/>0: No automation tools installed<br/>1: Automation tools installed                                                                                      |
| b_monkey_apps_last_ts              | int                  | Automation tools time                  |                                                                                                                                                                                                                                  |
| b_acc                              | int                  | Accessibility service                  | Device has accessibility service enabled, capable of automated operations, also possibly used for automated installation by some software, value: <br/>0: Accessibility service not enabled<br/>1: Accessibility service enabled |
| b_acc_last_ts                      | int                  | Accessibility service time             |                                                                                                                                                                                                                                  |
| b_multi_boxing_apps                | int                  | Multi-instance tools                   | Device installed with multi-instance tools, but not necessarily for the current APP, value: <br/>0: No multi-instance tools installed<br/>1: Multi-instance tools installed                                                      |
| b_multi_boxing_apps_last_ts        | int                  | Multi-instance time                    |                                                                                                                                                                                                                                  |
| b_hook                             | int                  | Hooked device                          | Process is injected with other code or libraries. Value: <br/>0: Process not injected with other code or libraries<br/>1: Process injected with other code or libraries                                                          |
| b_hook_last_ts                     | int                  | Hook time                              |                                                                                                                                                                                                                                  |
| b_vpn_apps                         | int                  | VPN tools                              | Device installed with VPN tools such as Sesame Proxy, value: 0: Not found 1: VPN tools installed                                                                                                                                 |
| b_vpn_apps_last_ts                 | int                  | VPN tools time                         |                                                                                                                                                                                                                                  |
| b_manufacture                      | int                  | Engineering mode                       | Device in engineering mode: <br/>0: Not in engineering mode<br/>1: In engineering mode                                                                                                                                           |
| b_manufacture_last_ts              | int                  | Engineering mode time                  |                                                                                                                                                                                                                                  |
| b_icloud                           | int                  | Not logged into iCloud account         | Device not logged into iCloud account, value: <br/>0: Device logged into iCloud account<br/>1: Device not logged into iCloud account                                                                                             |
| b_icloud_last_ts                   | int                  | Not logged into iCloud account time    |                                                                                                                                                                                                                                  |
| b_wx_code                          | int                  | WeChat code platform                   | Device installed with WeChat code platform, value: <br/>0: No WeChat code platform installed<br/>1: WeChat code platform installed                                                                                               |
| b_wx_code_last_ts                  | int                  | WeChat code platform time              |                                                                                                                                                                                                                                  |
| b_sms_code                         | int                  | SMS code platform                      | Device installed with SMS code platform, value: <br/>0: No SMS code platform installed<br/>1: SMS code platform installed                                                                                                        |
| b_sms_code_last_ts                 | int                  | SMS code platform time                 |                                                                                                                                                                                                                                  |
| b_low_osver                        | int                  | Low operating system version           | iOS device operating system version less than 9, value: <br/>0: iOS device operating system version not less than 9<br/>1: iOS device operating system version less than 9                                                       |
| b_low_osver_last_ts                | int                  | Low operating system version time      |                                                                                                                                                                                                                                  |
| b_remote_control_apps              | int                  | Remote control tools                   | Device using remote control tools, value: <br/>0: Device not using remote control tools<br/>1: Device using remote control tools                                                                                                 |
| b_remote_control_apps_last_ts      | int                  | Remote control tools time              |                                                                                                                                                                                                                                  |
| b_repackage                        | int                  | Repackaged                             | App name and signature do not match, value                                                                                                                                                                                       |
| b_IoT_card                         | int                  | Only use IoT network card devices      | Only applicable to IoT network card devices, value:<br/>0: No related risks，<br/>1: Only applicable to IoT network card devices                                                                                                  |
| b_IoT_card_last_ts                 | int                  | Only use IoT network card devices time |                                                                                                                                                                                                                                  |